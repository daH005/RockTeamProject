# RockTeam Project

Команда: RockTeam
Участники команды:
- Шевелев Данил Владимирович
- Григоренко Павел Александрович

Студенты УрГУПС, группа ИТ-312

# Цель проекта
Разработать сервис, который по видео мог бы находить и распознавать заданные лица, а также выводить таймкоды кадров.

# Практическое применение
- Поиск известных преступников по видео с камер
- Отметки появлений знаменитостей в видеофильмах

# Датасет
+-450 изображений в директории photos.

# Было рассмотрено 3 модели нейросети
## 1. Стандартная сверточная нейросеть
Состав:
- 3 сверточных слоя (32 -> 64 -> 128)
- 128 нейронов

### 20 эпох, 12 батчей по 32:
`Validation Accuracy: 0.3`
```
Epoch 20/20
12/12 ━━━━━━━━━━━━━━━━━━━━ 9s 744ms/step - accuracy: 1.0000 - loss: 5.8378e-04 - val_accuracy: 0.3056 - val_loss: 6.7305
```
Реализация нейросети и подсчёт accuracy в модуле own_models/common_network_train.py

## 2. Сравнительная сверточная нейросеть
Состав:
- Две ветки из:
- 2 сверточных слоя (64 -> 128)
- 128 нейронов
- Определение сходства по Евклидовому расстоянию

### 20 эпох, 272 батча по 32:
`Validation Accuracy: 0.48`
```
Epoch 20/20
272/272 ━━━━━━━━━━━━━━━━━━━━ 623s 2s/step - accuracy: 0.4581 - loss: nan - val_accuracy: 0.4867 - val_loss: nan
```

### 1 эпоха, 5085 батчей по 32:
`Validation Accuracy: 0.82`
```
Epoch 1/1
5085/5085 ━━━━━━━━━━━━━━━━━━━━ 11651s 2s/step - accuracy: 0.8437 - loss: 0.4936 - val_accuracy: 0.8281 - val_loss: 0.5366
```

Реализация нейросети и подсчёт accuracy в модуле own_models/siamese_network_train.py

## 3. Сравнительная модель FaceNet512 из пакета deepface
`Validation Accuracy: 1.0`
Accuracy посчитан вручную. Реализация в модуле _facenet512_calc_accuracy.py

# Определение координат лиц
Через пакет deepface (под капотом Yolov8)

# Доступ к сервису (http://localhost:8080)
- Через веб-интерфейс
- Через API

# Запуск проекта локально (Проект разрабатывался и тестировался исключительно на Linux. Работа не Windows не проверялась, но не исключается)
1. Определите файл .env в корне проекта. Пример содержимого:
```env
HOST=0.0.0.0
PORT=8080
DEBUG=False
```
2. Установите Docker и воспользуйтесь установщиком run_project.sh (`sudo sh run_project.sh`)
Важно: если вы поменяли порт в переменной `PORT`, то его также нужно изменить в `run_project` (пример - `ваш_порт:8080`)

# Демо проекта (с видео низкого качества программа может делать ошибки)
[demo.webm](https://github.com/user-attachments/assets/ee4f4b1a-a4ef-4ec5-8640-daa48df13851)

# Перспективы
- Улучшение работы с видео/изображениями низкого качества
- Распределённая обработка запросов через кластер

# Ссылка на наши модели (common - 0.3, siamese - 0.48, 0.82):
https://disk.yandex.ru/d/fdL2o-Mdor1cFQ

# Ссылка на презентацию проекта
...
